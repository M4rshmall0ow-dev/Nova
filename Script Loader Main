local Loader = {}
Loader.__index = Loader

local Services = {
    StarterGui = game:GetService("StarterGui"),
    Players = game:GetService("Players"),
    HttpService = game:GetService("HttpService")
}

Loader.Config = {
    DebugMode = true,
    NotificationDuration = 5
}

Loader.Games = {
    [126509999114328] = {
        Name = "99 Nights in Forest",
        Script = 'loadstring(game:HttpGet("loadstring(game:HttpGet("https://api.luarmor.net/files/v4/loaders/bcdc1084ce2b1e4df151d04c7257d10b.lua"))()"))()'
    },
    [131623223084840] = {
        Name = "Escape Tsunami For Brainrot!",
        Script = 'loadstring(game:HttpGet("loadstring(game:HttpGet("https://api.luarmor.net/files/v4/loaders/9392c6336e05a60f4136ad06bfbd873a.lua"))()"))()'
    }
}

function Loader:Log(message, isError)
    if not self.Config.DebugMode then return end
    local prefix = isError and "[-] [ERROR]: " or "[+] [INFO]: "
    if isError then
        warn(prefix .. message)
    else
        print(prefix .. message)
    end
end

function Loader:Notify(title, text)
    pcall(function()
        Services.StarterGui:SetCore("SendNotification", {
            Title = title;
            Text = text;
            Duration = self.Config.NotificationDuration;
        })
    end)
end

function Loader:ExecuteScript(gameData)
    self:Log("Attempting to execute script for: " .. gameData.Name)
    self:Notify("Script Loader", "Loading " .. gameData.Name .. "...")

    local success, err = pcall(function()
        local func = loadstring(gameData.Script)
        if typeof(func) == "function" then
            task.spawn(func)
        else
            error("Invalid loadstring response")
        end
    end)

    if success then
        self:Log("Execution successful.")
        self:Notify("Success", "Loaded " .. gameData.Name)
    else
        self:Log("Execution failed: " .. tostring(err), true)
        self:Notify("Error", "Failed to load script. Check console (F9).")
    end
end

function Loader:Init()
    if not game:IsLoaded() then
        game.Loaded:Wait()
    end

    local currentPlaceId = game.PlaceId
    local detectedGame = self.Games[currentPlaceId]

    self:Log("Loader initialized. Current ID: " .. currentPlaceId)

    if detectedGame then
        self:ExecuteScript(detectedGame)
    else
        self:Log("No supported script found for this game.")
    end
end

return Loader:Init()
